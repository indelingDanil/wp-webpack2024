# WordPress Starter Theme

This is a WordPress starter theme built with Webpack, designed to streamline theme development in 2024. The theme utilizes modern tools and technologies to enhance your development workflow.

## Features

- **Webpack Integration**: The theme is powered by Webpack, enabling efficient bundling of JavaScript and CSS assets.
- **SCSS Support**: Write your styles using SCSS, and Webpack will compile them into optimized CSS files.
- **Environment Variables**: The theme leverages the `.env` file to manage environment-specific variables, such as `WP_SITE_URL`, allowing easy switching between development and production environments.
- **Automatic URL Sync**: A custom function in `functions.php` automatically syncs the `WP_SITE_URL` variable in your `.env` file with the current site URL. This is especially useful during development.
- **CSS and JS Minification**: In production mode, the theme automatically minifies CSS and JavaScript files using `CssMinimizerPlugin` and `TerserPlugin`.
- **Automatic Browser Reloading**: With `BrowserSync`, the theme supports live reloading during development. Changes in PHP, CSS, or JS files trigger an automatic browser refresh.
- **Hot Module Replacement**: Webpack's development server provides hot module replacement, ensuring that changes to JavaScript and CSS are reflected immediately without a full page reload.
- **Cross-Platform Support**: The theme uses `cross-env` to ensure environment variables are correctly set on different operating systems.

## Installation

1. Clone the repository to your WordPress themes directory.
2. Run `pnpm install` to install the required dependencies.
3. Copy the `.env.example` file to `.env` and update the `WP_SITE_URL` with your site's URL.
4. Use `pnpm start` to begin development with automatic file watching and browser reloading.
5. Use `pnpm run build` to create a production build with optimized and minified assets.

## Scripts

- **`pnpm start`**: Starts Webpack in development mode with file watching and live reloading.
- **`pnpm run build`**: Builds the theme for production, minifying CSS and JavaScript files.

## File Structure

- **`src/`**: Contains your source JavaScript and SCSS files.
- **`assets/`**: Generated by Webpack, this directory contains the minified CSS and JS files.
- **`.env`**: Environment configuration file to set site-specific variables.

## Automatic URL Sync in Development

In the `functions.php` file, there is a custom function that automatically updates the `WP_SITE_URL` variable in your `.env` file to match the current site URL:

```php
function update_wp_site_url_in_env() {
    $env_file_path = __DIR__ . '/.env';

    if (!file_exists($env_file_path)) {
        return;
    }

    $env_content = file_get_contents($env_file_path);
    preg_match('/^WP_SITE_URL=(.*)$/m', $env_content, $matches);
    $current_env_url = isset($matches[1]) ? trim($matches[1]) : '';
    $current_site_url = get_site_url();

    if ($current_env_url !== $current_site_url) {
        $new_env_content = preg_replace('/^WP_SITE_URL=.*$/m', 'WP_SITE_URL=' . $current_site_url, $env_content);
        file_put_contents($env_file_path, $new_env_content);
    }
}

add_action('init', 'update_wp_site_url_in_env');
```

## Important Note for Production

Before deploying your theme to a production environment, it is recommended to remove or comment out the update_wp_site_url_in_env function in functions.php. This function is designed for development purposes and may not be needed in production.

# Requirements

    Node.js 20.14.0+
    PNPM (recommended package manager 9.6.0+)
    WordPress installation

# License

This theme is licensed under the ISC License.


# Стартовая Тема WordPress

Это стартовая тема WordPress, построенная с использованием Webpack, которая предназначена для оптимизации разработки тем в 2024 году. Тема использует современные инструменты и технологии для улучшения рабочего процесса разработки.

## Возможности

- **Интеграция с Webpack**: Тема использует Webpack для эффективного объединения JavaScript и CSS файлов.
- **Поддержка SCSS**: Пишите стили с использованием SCSS, и Webpack скомпилирует их в оптимизированные CSS-файлы.
- **Переменные окружения**: Тема использует файл `.env` для управления переменными окружения, такими как `WP_SITE_URL`, что позволяет легко переключаться между средами разработки и продакшена.
- **Автоматическая синхронизация URL**: В файле `functions.php` реализована функция, которая автоматически синхронизирует переменную `WP_SITE_URL` в вашем `.env` файле с текущим URL сайта. Это особенно полезно при разработке.
- **Минификация CSS и JS**: В продакшн-режиме тема автоматически минимизирует CSS и JavaScript файлы с помощью `CssMinimizerPlugin` и `TerserPlugin`.
- **Автоматическая перезагрузка браузера**: С помощью `BrowserSync` тема поддерживает live reloading во время разработки. Изменения в PHP, CSS или JS файлах приводят к автоматической перезагрузке браузера.
- **Горячая замена модулей**: Сервер разработки Webpack предоставляет горячую замену модулей, что обеспечивает мгновенное отражение изменений в JavaScript и CSS без полной перезагрузки страницы.
- **Кроссплатформенная поддержка**: Тема использует `cross-env`, чтобы гарантировать корректную настройку переменных окружения на разных операционных системах.

## Установка

1. Клонируйте репозиторий в каталог тем вашего WordPress.
2. Запустите `pnpm install` для установки необходимых зависимостей.
3. Скопируйте файл `.env.example` в `.env` и обновите `WP_SITE_URL` на URL вашего сайта.
4. Используйте `pnpm start` для запуска разработки с автоматическим отслеживанием файлов и перезагрузкой браузера.
5. Используйте `pnpm run build` для создания продакшн сборки с оптимизированными и минимизированными ассетами.

## Скрипты

- **`pnpm start`**: Запускает Webpack в режиме разработки с отслеживанием файлов и live reloading.
- **`pnpm run build`**: Создает сборку для продакшена, минимизируя CSS и JavaScript файлы.

## Структура Файлов

- **`src/`**: Содержит исходные файлы JavaScript и SCSS.
- **`assets/`**: Генерируется Webpack, этот каталог содержит минимизированные CSS и JS файлы.
- **`.env`**: Файл конфигурации окружения для установки специфических переменных сайта.

## Автоматическая Синхронизация URL в Разработке

В файле `functions.php` есть функция, которая автоматически обновляет переменную `WP_SITE_URL` в вашем `.env` файле, чтобы она соответствовала текущему URL сайта:

```php
function update_wp_site_url_in_env() {
    $env_file_path = __DIR__ . '/.env';

    if (!file_exists($env_file_path)) {
        return;
    }

    $env_content = file_get_contents($env_file_path);
    preg_match('/^WP_SITE_URL=(.*)$/m', $env_content, $matches);
    $current_env_url = isset($matches[1]) ? trim($matches[1]) : '';
    $current_site_url = get_site_url();

    if ($current_env_url !== $current_site_url) {
        $new_env_content = preg_replace('/^WP_SITE_URL=.*$/m', 'WP_SITE_URL=' . $current_site_url, $env_content);
        file_put_contents($env_file_path, $new_env_content);
    }
}

add_action('init', 'update_wp_site_url_in_env');
```

## Важно для Продакшена

Перед развертыванием вашей темы в продакшн среду рекомендуется удалить или закомментировать функцию update_wp_site_url_in_env в functions.php. Эта функция предназначена для разработки и может быть не нужна в продакшене.

# Требования

    Node.js 20.14.0+
    PNPM (рекомендуемый менеджер пакетов 9.6.0+)
    Установка WordPress

# Лицензия

Эта тема лицензируется под лицензией ISC.